seq(5, 20, by = 2)
library(clusterExperiment)
# SMARTer-Nuclei
# Pre
# Post
clusMat <- readRDS("../../data/Smart-Seq/SMARTer_cells_MOp_Consensus_Clustering.rds")
sapply(clusMat$currentMat, function(x) length(unique(x)))
df <_ clusMat$currentMat
df <- clusMat$currentMat
View(df)
apply(clusMat$currentMat, 2, function(x) length(unique(x)))
View(df)
# SMARTer-Nuclei
# Pre
# sc3    Rsec   allen seurat1 seurat2
# 30      24      49      15      17
# Post
clusMat <- readRDS("../../data/Smart-Seq/SMARTer_nuclei_MOp_Consensus_Clustering.rds")
# SMARTer-Nuclei
# Pre
# sc3    Rsec   allen seurat1 seurat2
# 30      24      49      15      17
# Post
clusMat <- readRDS("../../data/Smart-Seq/SMARTer_nuclei_MOp_Consensus_Clustering.rds")
apply(clusMat$currentMat, 2, function(x) length(unique(x)))
clusMat$currentMat[,"Rsec"] == -1
sum(clusMat$currentMat[,"Rsec"] == -1)
# SMARTer-Nuclei
# Pre
# sc3    Rsec   allen seurat1 seurat2
# 30      24      49      15      17
# Post
clusMat <- readRDS("../../data/Smart-Seq/SMARTer_nuclei_MOp_Consensus_Clustering.rds")
apply(clusMat$currentMat, 2, function(x) length(unique(x)))
out <- apply(clusMat$currentMat, 2, function(x) length(unique(x)))
df <- data.frame(methods = names(out),
before = c(30, 24, 49, 15, 17),
after = out)
library(tidyverse)
df <- data.frame(methods = names(out),
before = c(30, 24, 49, 15, 17),
after = out) %>%
gather(key = "time", value = "Nb", -methods)
ggplot(df, aes(x = methods, y = Nb)) +
geom_bar()
ggplot(df, aes(x = methods, y = Nb)) +
geom_bar(stat = "identity")
ggplot(df, aes(x = methods, y = Nb, col = time)) +
geom_bar(stat = "identity") +
theme_classic()
ggplot(df, aes(x = methods, y = Nb, fill = time)) +
geom_bar(stat = "identity", position = "dodge") +
theme_classic()
df <- data.frame(methods = names(out),
before = c(30, 24, 49, 15, 17),
after = out) %>%
gather(key = "time", value = "Nb", -methods) %>%
mutate(time = factor(time, levels = c("before", "after")))
ggplot(df, aes(x = methods, y = Nb, fill = time)) +
geom_bar(stat = "identity", position = "dodge") +
theme_classic()
ggplot(df, aes(x = methods, y = Nb, fill = time)) +
geom_bar(stat = "identity", position = "dodge") +
theme_classic() +
scale_fill_viridis_d()
ggplot(df, aes(x = methods, y = Nb, fill = time)) +
geom_bar(stat = "identity", position = "dodge") +
theme_classic() +
scale_fill_viridis_d(option = "B")
ggplot(df, aes(x = methods, y = Nb, fill = time)) +
geom_bar(stat = "identity", position = "dodge") +
theme_classic() +
scale_fill_viridis_d(option = "A")
ggplot(df, aes(x = methods, y = Nb, fill = time)) +
geom_bar(stat = "identity", position = "dodge") +
theme_classic() +
scale_fill_viridis_d(option = "C")
ggplot(df, aes(x = methods, y = Nb, fill = time)) +
geom_bar(stat = "identity", position = "dodge") +
theme_classic() +
scale_fill_viridis_d(option = "D")
ggplot(df, aes(x = methods, y = Nb, fill = time)) +
geom_bar(stat = "identity", position = "dodge") +
theme_classic() +
scale_fill_viridis_d(option = "E")
ggplot(df, aes(x = methods, y = Nb, fill = time)) +
geom_bar(stat = "identity", position = "dodge") +
theme_classic() +
scale_fill_viridis_d(option = "A")
ggplot(df, aes(x = methods, y = Nb, fill = time)) +
geom_bar(stat = "identity", position = "dodge") +
theme_classic() +
scale_fill_viridis_d(option = "B")
ggplot(df, aes(x = methods, y = Nb, fill = time)) +
geom_bar(stat = "identity", position = "dodge") +
theme_classic() +
scale_fill_viridis_d(option = "E")
ggplot(df, aes(x = methods, y = Nb, fill = time)) +
geom_bar(stat = "identity", position = "dodge") +
theme_classic() +
scale_fill_viridis_d(option = "E") +
labs(x = "Clustering Methods", y = "Number of clusters", fill = "") +
ggtitle("Reduction in number of clusters with consensus merging, for nuclei")
library(tidyverse)
loc <- "/scratch/users/singlecell/MiniAtlas/data/rds/SMARTer_nuclei_MOp_zinbWs.rds"
# SMARTer-Nuclei
# Pre
# sc3    Rsec   allen seurat1 seurat2
# 30      24      49      15      17
# Post
clusMat <- readRDS("../../data/Smart-Seq/SMARTer_nuclei_MOp_Consensus_Clustering.rds")
out <- apply(clusMat$currentMat, 2, function(x) length(unique(x)))
df <- data.frame(methods = names(out),
before = c(30, 24, 49, 15, 17),
after = out) %>%
gather(key = "time", value = "Nb", -methods) %>%
mutate(time = factor(time, levels = c("before", "after")))
ggplot(df, aes(x = methods, y = Nb, fill = time)) +
geom_bar(stat = "identity", position = "dodge") +
theme_classic() +
scale_fill_viridis_d(option = "E") +
labs(x = "Clustering Methods", y = "Number of clusters", fill = "") +
ggtitle("Reduction in number of clusters with consensus merging")
ggsave("../../Figures/Smart-Seq/SMARTer_nuclei_MOp_clusters_nb.pdf")
# SMARTer-cell
# Pre
# sc3    Rsec   allen seurat1 seurat2
# 27      40      62      13      19
# Post
clusMat <- readRDS("../../data/Smart-Seq/SMARTer_cells_MOp_Consensus_Clustering.rds")
out <- apply(clusMat$currentMat, 2, function(x) length(unique(x)))
df <- data.frame(methods = names(out),
before = c(27, 40, 62, 13, 19),
after = out) %>%
gather(key = "time", value = "Nb", -methods) %>%
mutate(time = factor(time, levels = c("before", "after")))
ggplot(df, aes(x = methods, y = Nb, fill = time)) +
geom_bar(stat = "identity", position = "dodge") +
theme_classic() +
scale_fill_viridis_d(option = "E") +
labs(x = "Clustering Methods", y = "Number of clusters", fill = "") +
ggtitle("Reduction in number of clusters with consensus merging")
ggsave("../../Figures/Smart-Seq/SMARTer_cells_MOp_clusters_nb.pdf")
