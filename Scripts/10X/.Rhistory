getwd()
clusMat <- readRDS("../../seurat_ARI.rds")
library(ggplot2)
library(dplyr)
library(tidyr)
plotARIs <- function(ARI) {
p <- ARI %>% as.data.frame() %>%
mutate(label = rownames(ARI)) %>%
gather(key = label2, value = ari, -(ncol(ARI) + 1)) %>%
ggplot(aes(x = label, y = label2, fill = ari)) +
geom_tile() +
guides(fill = F) +
scale_fill_viridis_c() +
theme_classic() +
theme(axis.line = element_blank()) +
geom_text(aes(label = round(ari, 2))) +
NULL
return(p)
}
heatmap(clusMat)
plotARIs(clusMat) +
ggtitle("Seurat concordance: ARIs for every pair of pais of parameters (resolution and k.param)")
library(tidyverse)
ind <- str_detect(rownames(clusMat), "0\\.4")
clusMat2 <- clusMat[ind, ind]
plotARIs(clusMat2) +
ggtitle("Seurat concordance: ARIs for every pair of pais of parameters (resolution and k.param)")
ind <- str_detect(rownames(clusMat), "10$")
clusMat2 <- clusMat[!ind, !ind]
plotARIs(clusMat2) +
ggtitle("Seurat concordance: ARIs for every pair of pais of parameters (resolution and k.param)")
heatmap(clusMat2)
apply(clusMat, 2, function(x){
length(unique(x))
})
View(clusMat)
library(stringr)
library(clusterExperiment)
library(dplyr)
library(BiocParallel)
library(zinbwave)
# Run sc3 per se ----
library(SC3)
seq(10, 50, 5)
length(seq(10, 50, 5))
